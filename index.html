<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spy Files - Gallery Terminal</title>
<style>
  /* Reset */
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: "Courier New", Courier, monospace;
    background: #0b0c0d;
    color: #33ff33;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    background: #002200;
    display: flex;
    align-items: center;
    padding: 10px 20px;
    gap: 10px;
  }
  header img {
    height: 40px;
    width: auto;
  }
  header h1 {
    margin: 0;
    font-weight: normal;
    font-size: 1.5rem;
  }

  main {
    flex: 1;
    padding: 15px;
    max-width: 900px;
    margin: auto;
    width: 100%;
  }

  /* Password form */
  #passwordSection {
    max-width: 400px;
    margin: 40px auto;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  #passwordSection input[type="password"] {
    padding: 10px;
    font-size: 1.1rem;
    background: #001100;
    border: 2px solid #33ff33;
    color: #33ff33;
    outline-offset: 2px;
  }
  #passwordSection button {
    padding: 10px;
    font-size: 1.1rem;
    background: #004400;
    border: none;
    color: #33ff33;
    cursor: pointer;
    transition: background 0.3s;
  }
  #passwordSection button:hover {
    background: #008800;
  }
  #passwordError {
    color: #ff4444;
    font-weight: bold;
  }

  /* Gallery */
  #gallery {
    display: none;
    margin-top: 10px;
    gap: 10px;
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(120px,1fr));
    justify-items: center;
  }
  #gallery img {
    max-width: 100%;
    border: 2px solid #33ff33;
    cursor: pointer;
    border-radius: 4px;
    transition: transform 0.2s ease;
  }
  #gallery img:hover {
    transform: scale(1.05);
  }

  /* Fullscreen overlay */
  #fullscreenOverlay {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.95);
    justify-content: center;
    align-items: center;
    z-index: 1000;
    flex-direction: column;
  }
  #fullscreenOverlay img {
    max-width: 90vw;
    max-height: 80vh;
    object-fit: contain;
    cursor: grab;
  }
  #closeBtn {
    position: absolute;
    top: 20px;
    right: 25px;
    font-size: 2rem;
    color: #33ff33;
    cursor: pointer;
    user-select: none;
  }

  /* Upload */
  #uploadSection {
    margin-top: 30px;
    max-width: 400px;
  }
  #uploadSection label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
  }
  #uploadSection input[type="file"] {
    width: 100%;
    background: #001100;
    border: 2px solid #33ff33;
    padding: 6px;
    color: #33ff33;
    cursor: pointer;
  }
  #uploadSection button {
    margin-top: 10px;
    padding: 10px;
    font-size: 1rem;
    background: #004400;
    border: none;
    color: #33ff33;
    cursor: pointer;
    width: 100%;
    transition: background 0.3s;
  }
  #uploadSection button:hover {
    background: #008800;
  }

  /* Responsive tweaks */
  @media (max-width: 480px) {
    header h1 {
      font-size: 1.2rem;
    }
    #passwordSection, #uploadSection {
      max-width: 90vw;
      margin: 20px auto;
    }
    #gallery {
      grid-template-columns: repeat(auto-fill,minmax(90px,1fr));
    }
  }
</style>
</head>
<body>

<header>
  <img src="https://raw.githubusercontent.com/moullakill/SPY-FILES/main/logo.png" alt="Spy Files Logo" />
  <h1>Spy Files - Terminal Gallery</h1>
</header>

<main>
  <section id="passwordSection">
    <input type="password" id="passwordInput" placeholder="Entrez le mot de passe" autocomplete="off" />
    <button id="passwordBtn">Valider</button>
    <div id="passwordError"></div>
  </section>

  <section id="gallery"></section>

  <section id="uploadSection" style="display:none;">
    <label for="fileInput">Téléverser un fichier image :</label>
    <input type="file" id="fileInput" accept="image/*" />
    <button id="uploadBtn">Téléverser</button>
    <div id="uploadStatus"></div>
  </section>
</main>

<!-- Fullscreen overlay -->
<div id="fullscreenOverlay">
  <div id="closeBtn">&times;</div>
  <img id="fullImage" src="" alt="Image plein écran" />
</div>

<script>
  const PASSWORD = "coffee007";
  const PASSWORD_SECTION = document.getElementById("passwordSection");
  const PASSWORD_INPUT = document.getElementById("passwordInput");
  const PASSWORD_BTN = document.getElementById("passwordBtn");
  const PASSWORD_ERROR = document.getElementById("passwordError");

  const GALLERY = document.getElementById("gallery");
  const UPLOAD_SECTION = document.getElementById("uploadSection");
  const FILE_INPUT = document.getElementById("fileInput");
  const UPLOAD_BTN = document.getElementById("uploadBtn");
  const UPLOAD_STATUS = document.getElementById("uploadStatus");

  const FULLSCREEN_OVERLAY = document.getElementById("fullscreenOverlay");
  const FULL_IMAGE = document.getElementById("fullImage");
  const CLOSE_BTN = document.getElementById("closeBtn");

  const GITHUB_LOG_URL = "https://raw.githubusercontent.com/moullakill/SPY-FILES/main/machine_log.txt";
  const CORS_PROXY = "https://corsproxy.io/?";

  const UPLOAD_TOKEN = "hp_Y4GBkrjmC6dil8bZPDnYV6V2zQBp7B2HCZvs";
  const UPLOAD_API_URL = "https://api.web3.storage/upload";

  // --- Password check ---
  PASSWORD_BTN.onclick = () => {
    const val = PASSWORD_INPUT.value.trim();
    if(val === PASSWORD) {
      PASSWORD_ERROR.textContent = "";
      PASSWORD_SECTION.style.display = "none";
      GALLERY.style.display = "grid";
      UPLOAD_SECTION.style.display = "block";
      loadGallery();
    } else {
      PASSWORD_ERROR.textContent = "Mot de passe incorrect";
    }
  };

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SPY FILES - Gallery</title>
<style>
  /* Thème terminal */
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

  body {
    margin: 0; padding: 0;
    background-color: #0f0f0f;
    color: #33ff33;
    font-family: 'Share Tech Mono', monospace;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    padding: 15px;
    background: #000;
    text-align: center;
    border-bottom: 2px solid #33ff33;
  }

  header img {
    height: 50px;
    vertical-align: middle;
  }

  h1 {
    display: inline-block;
    margin-left: 10px;
    font-weight: normal;
  }

  #login-section, #gallery-section {
    flex: 1;
    padding: 10px;
    max-width: 900px;
    margin: auto;
  }

  #login-section {
    margin-top: 60px;
    text-align: center;
  }

  input[type="password"] {
    font-family: 'Share Tech Mono', monospace;
    font-size: 1.2rem;
    padding: 8px;
    width: 60vw;
    max-width: 300px;
    background: #111;
    border: 1px solid #33ff33;
    color: #33ff33;
  }

  button {
    font-family: 'Share Tech Mono', monospace;
    font-size: 1.1rem;
    padding: 8px 20px;
    margin-left: 10px;
    background: #000;
    color: #33ff33;
    border: 1px solid #33ff33;
    cursor: pointer;
  }
  button:hover {
    background: #33ff33;
    color: #000;
  }

  #error-msg {
    margin-top: 15px;
    color: #f33;
    font-weight: bold;
  }

  #gallery {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(150px,1fr));
    gap: 12px;
    margin-top: 20px;
  }

  .image-container {
    background: #111;
    border: 1px solid #33ff33;
    padding: 5px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }
  .image-container img {
    width: 100%;
    height: auto;
    display: block;
    transition: transform 0.3s ease;
  }
  .image-container:hover img {
    transform: scale(1.05);
  }

  /* Fullscreen viewer */
  #fullscreen-viewer {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.95);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    flex-direction: column;
  }

  #fullscreen-viewer img {
    max-width: 95vw;
    max-height: 85vh;
    border: 2px solid #33ff33;
    border-radius: 4px;
    cursor: grab;
    touch-action: none;
  }

  #close-btn {
    margin-top: 15px;
    background: #000;
    border: 1px solid #33ff33;
    color: #33ff33;
    font-family: 'Share Tech Mono', monospace;
    font-size: 1.2rem;
    padding: 5px 15px;
    cursor: pointer;
    border-radius: 3px;
  }
  #close-btn:hover {
    background: #33ff33;
    color: #000;
  }

  /* Responsive adjustments */
  @media (max-width: 480px) {
    input[type="password"] {
      width: 80vw;
    }
    button {
      margin-top: 10px;
      margin-left: 0;
      width: 80vw;
    }
    #gallery {
      grid-template-columns: repeat(auto-fit,minmax(120px,1fr));
      gap: 8px;
    }
  }
</style>
</head>
<body>

<header>
  <img src="https://raw.githubusercontent.com/moullakill/SPY-FILES/main/logo.png" alt="Logo SPY FILES" />
  <h1>SPY FILES - Galerie</h1>
</header>

<section id="login-section">
  <label for="password-input">Entrez le mot de passe :</label><br />
  <input type="password" id="password-input" placeholder="Mot de passe" autocomplete="off" />
  <button id="login-btn">Valider</button>
  <div id="error-msg"></div>
</section>

<section id="gallery-section" style="display:none;">
  <div id="gallery"></div>
</section>

<!-- Fullscreen viewer -->
<div id="fullscreen-viewer">
  <img src="" alt="Image agrandie" id="full-img" />
  <button id="close-btn">✕ Fermer</button>
</div>

<script>
  const PASSWORD = "coffee 007";
  const GITHUB_LOG_URL = "https://raw.githubusercontent.com/moullakill/SPY-FILES/main/machine_log.txt";
  const CORS_PROXY = "https://corsproxy.io/?";

  const loginSection = document.getElementById('login-section');
  const gallerySection = document.getElementById('gallery-section');
  const passwordInput = document.getElementById('password-input');
  const loginBtn = document.getElementById('login-btn');
  const errorMsg = document.getElementById('error-msg');
  const gallery = document.getElementById('gallery');

  const fullscreenViewer = document.getElementById('fullscreen-viewer');
  const fullImg = document.getElementById('full-img');
  const closeBtn = document.getElementById('close-btn');

  // Afficher la galerie
  async function loadGallery() {
    gallery.innerHTML = "<p>Chargement des images...</p>";
    try {
      const response = await fetch(CORS_PROXY + encodeURIComponent(GITHUB_LOG_URL));
      if (!response.ok) throw new Error("Impossible de charger le fichier de log");
      const text = await response.text();

      gallery.innerHTML = ""; // Clear
      const lines = text.split("\n").filter(l => l.trim().length > 0);
      for (const line of lines) {
        // Chaque ligne est sous forme uid: base64data
        const parts = line.split(":", 2);
        if(parts.length < 2) continue;
        const base64data = parts[1].trim();

        // On va détecter l'extension en regardant le début du base64
        let ext = "png";
        if(base64data.startsWith("iVBOR")) ext = "png";
        else if(base64data.startsWith("/9j/")) ext = "jpg";
        else if(base64data.startsWith("R0lG")) ext = "gif";

        const img = document.createElement("img");
        img.src = `data:image/${ext};base64,${base64data}`;
        img.alt = "Spy File Image";
        img.loading = "lazy";

        const container = document.createElement("div");
        container.classList.add("image-container");
        container.appendChild(img);

        // Click pour plein écran
        container.addEventListener("click", () => openFullscreen(img.src));

        gallery.appendChild(container);
      }
      if(gallery.innerHTML === "") {
        gallery.innerHTML = "<p>Aucune image trouvée.</p>";
      }
    } catch (err) {
      gallery.innerHTML = `<p style="color:#f33;">Erreur: ${err.message}</p>`;
    }
  }

  function openFullscreen(src) {
    fullImg.src = src;
    fullscreenViewer.style.display = "flex";
  }
  closeBtn.onclick = () => {
    fullscreenViewer.style.display = "none";
    fullImg.src = "";
  };

  // Simple zoom sur l'image fullscreen (scroll ou pincement)
  let scale = 1;
  fullImg.style.transformOrigin = "center center";

  fullscreenViewer.addEventListener("wheel", e => {
    e.preventDefault();
    if(e.deltaY < 0) {
      scale = Math.min(scale + 0.1, 5);
    } else {
      scale = Math.max(scale - 0.1, 1);
    }
    fullImg.style.transform = `scale(${scale})`;
  });

  // Login handler
  loginBtn.addEventListener("click", () => {
    const pass = passwordInput.value.trim();
    if (pass === PASSWORD) {
      errorMsg.textContent = "";
      loginSection.style.display = "none";
      gallerySection.style.display = "block";
      loadGallery();
    } else {
      errorMsg.textContent = "Mot de passe incorrect";
    }
  });

  // Enter key triggers login
  passwordInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      loginBtn.click();
    }
  });
</script>

</body>
</html>

      if(imgs.length === 0) {
        GALLERY.innerHTML = "<p>Aucune image disponible.</p>";
        return;
      }

      // Affiche images
      GALLERY.innerHTML = "";
      imgs.forEach(src => {
        const img = document.createElement("img");
        img.src = src;
        img.alt = "Spy File Image";
        img.loading = "lazy";
        img.onclick = () => openFullscreen(src);
        GALLERY.appendChild(img);
      });

    } catch(err) {
      GALLERY.innerHTML = `<p style="color:#f33;">Erreur: ${err.message}</p>`;
    }
  }

  // --- Fullscreen image ---
  function openFullscreen(src) {
    FULL_IMAGE.src = src;
    FULLSCREEN_OVERLAY.style.display = "flex";
    FULL_IMAGE.style.transform = "scale(1)";
    currentScale = 1;
  }
  CLOSE_BTN.onclick = () => {
    FULLSCREEN_OVERLAY.style.display = "none";
    FULL_IMAGE.src = "";
  };

  // Zoom with mousewheel on fullscreen image
  let currentScale = 1;
  FULL_IMAGE.addEventListener("wheel", e => {
    e.preventDefault();
    const delta = e.deltaY > 0 ? -0.1 : 0.1;
    currentScale = Math.min(Math.max(0.5, currentScale + delta), 3);
    FULL_IMAGE.style.transform = `scale(${currentScale})`;
  });

  // --- Upload ---
  UPLOAD_BTN.onclick = async () => {
    if (!FILE_INPUT.files.length) {
      UPLOAD_STATUS.textContent = "Veuillez choisir un fichier.";
      UPLOAD_STATUS.style.color = "#f33";
      return;
    }
    const file = FILE_INPUT.files[0];
    UPLOAD_STATUS.textContent = "Téléversement en cours...";
    UPLOAD_STATUS.style.color = "#33ff33";

    try {
      const res = await fetch(UPLOAD_API_URL, {
        method: "POST",
        headers: {
          Authorization: `Bearer ${UPLOAD_TOKEN}`
        },
        body: file
      });
      if (!res.ok) throw new Error(`Erreur HTTP ${res.status}`);
      const data = await res.json();
      UPLOAD_STATUS.textContent = `Téléversement réussi! CID: ${data.cid}`;
      FILE_INPUT.value = "";
    } catch (err) {
      UPLOAD_STATUS.textContent = "Erreur lors du téléversement: " + err.message;
      UPLOAD_STATUS.style.color = "#f33";
    }
  };
</script>

</body>
</html>
